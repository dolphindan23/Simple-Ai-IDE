Ticket 1 — Workflow engine + checkpoints (Phase D1)

Implement a workflow-run engine for agent tasks.
Add TaskRun + StepRun persistence under .simpleide/runs/<runId>/:

run.json metadata (goal, started_at, status)

step folders 01_plan/, 02_implement/, 03_review/, 04_test/, 05_fix_01/, etc.
Each step writes:

input.json (role, backend/model chosen, files referenced)

output artifact(s): plan.json / patch.diff / review.md / test.log

status.json with duration and pass/fail.
Add API:

POST /api/runs create run

POST /api/runs/:id/step execute a step

GET /api/runs/:id full run state

POST /api/runs/:id/rerun?fromStep= rerun from checkpoint
Add UI: a “Run Timeline” panel showing steps and allowing rerun from any step.

Ticket 2 — Autonomous test/fix loop (Phase D2)

Add an “Implement (Auto)” action that runs:

Planner (optional)

Coder generates unified diff only

Apply diff to a temporary git worktree/branch (not directly to main working tree)

Run checks: lint + tests (allowlist)

If failure: call TestFixer role with the failure logs and request a revised diff
Repeat up to N=3 loops.
Only present the final patch to the user when checks pass, or show the best attempt + failure summary if all retries fail.
Log each loop as its own StepRun and persist artifacts.

Ticket 3 — Project Bible + diff guardrails (Phase D3)

Add .simpleide/PROJECT_BIBLE.md and .simpleide/repo_facts.json generation.

repo_facts includes detected package manager + dependencies + frameworks.
The orchestrator must prepend PROJECT_BIBLE + repo_facts to every role prompt.
Add guardrails:

.simpleide/guardrails.json with denyPatterns/denyFiles/denyDependencies

After diff generation, scan diff: if it violates guardrails, reject and ask agent to fix.
Add UI to edit Project Bible and guardrails inside Settings.

Ticket 4 — Observability timeline (Phase D4)

Add structured tracing for each run:

Each agent call logs {role, backend, model, tokens? (optional), latency}

Each tool call logs {toolName, args, exitCode}

Timeline UI shows events; clicking opens artifacts.
Ensure logs are redacted using redactSecrets().